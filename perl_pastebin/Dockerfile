# Используем официальный, стабильный образ Perl
FROM perl:5.38

# Устанавливаем cpanminus - менеджер пакетов для Perl
RUN curl -L https://cpanmin.us | perl - App::cpanminus

# Создаем рабочую директорию внутри контейнера
WORKDIR /app

# Копируем cpanfile и устанавливаем зависимости.
# Этот слой кэшируется, чтобы не переустанавливать модули при каждом изменении кода.
COPY cpanfile /app/
RUN cpanm --installdeps .

# Копируем все файлы приложения в рабочую директорию
COPY . /app/

# Сообщаем Docker, что наше приложение будет слушать порт 3000
EXPOSE 3000

# Команда по умолчанию для запуска нашего веб-сервера.
# Используем 'morbo' - сервер для разработки, который автоматически
# перезагружается при изменении файлов.
CMD ["morbo", "-l", "http://*:3000", "pastebin.pl"]